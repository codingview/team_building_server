!function(t){function n(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var e={};n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=20)}([function(t,n,e){"use strict";t.exports=function(t){return new Promise(function(n,e){var a="text"in t?t.text:"";$.ajax({url:t.url,type:"type"in t?t.type:"post",data:"data"in t?t.data:{},dataType:"json",success:function(t){t&&"status"in t&&t.status>0?n(t.data):e("message"in t?t.message:a+"出错")},error:function(t){console.error(t),e(a+"超时")}})})}},function(t,n,e){"use strict";t.exports={processing:"玩命加载中...",lengthMenu:"每页显示 _MENU_ 条",zeroRecords:"没有匹配记录",info:"共计: _TOTAL_ 条 第 _PAGE_ / _PAGES_ 页",infoEmpty:"共计: 0 条 ",infoFiltered:"",infoPostFix:"",search:"搜索:",loadingRecords:"载入中...",url:"",paginate:{first:"首页",previous:"上一页",next:"下一页",last:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}}},function(t,n,e){"use strict";t.exports=["head","bold","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","emoticon","image","table","code","undo","redo"]},function(t,n,e){"use strict";(function(){Date.prototype.format=function(t){var n={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":this.getDay(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var e in n)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[e]:("00"+n[e]).substr((""+n[e]).length)));return t}})()},function(t,n,e){"use strict";var a=void 0,i=e(0),o=window.wangEditor,r={add:function(t){return i({url:"/admin/production/add",type:"put",data:t,message:"新增产品"})},update:function(t){return i({url:"/admin/production/update",type:"put",data:t,message:"更新产品"})},catalogs:function(){return new Promise(function(t,n){return $.ajax({url:"/admin/production/catalog/list",type:"get",dataType:"json",success:function(e){e&&"status"in e&&e.status>0?t(e.data):n("message"in e?e.message:"获取分类列表出错")},error:function(t){console.error(t),n("获取分类列表超时")}})})}},s={setCatalogs:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"list",e="",a=parseInt($("#p_sci_val").val()),i=function(t){return t.id===a?"selected":""};return t.forEach(function(t){"list"===n||(e+='<optgroup label=" '+t.name+'">'),"second"in t&&Array.isArray(t.second)&&t.second.length>0&&t.second.forEach(function(n){e+='<option value="'+n.id+'" '+i(n)+' data-fci="'+t.id+'" data-sci="'+n.id+'"> >> '+n.name+"</option>"}),"list"!==n&&(e+="</optgroup>")}),e},setCatalogsKv:function(t){var n={};return t.forEach(function(t){t.second&&t.second.forEach(function(t){n[t.id]=t.name})}),n},editor:function(){return a=new o("#p_editor"),a.customConfig.menus=e(2),a.customConfig.uploadImgShowBase64=!0,a.customConfig.uploadImgMaxLength=5,a.customConfig.pasteFilterStyle=!1,a.create(),a},catalogs:function(){return r.catalogs().then(function(t){$("#p_sci").html(s.setCatalogs(t,"add"))}).catch(function(t){console.error(t),alert("获取分类列表出错")})},getForm:function(){for(var t={},n=$("#p_form"),e=n.find("input,select"),a=0,i=e.length;a<i;a++){var o=e.eq(a),r=o.attr("id").replace(/p_/g,"");"text"===r||("top"===r?t.top=o.is(":checked"):t[r]=o.val())}return t.fci=$("#p_sci").find('[data-sci="'+t.sci+'"]').data("fci"),t.abstract=$("#p_abstract").val(),t},init:function(){this.catalogs()}},c={reset:function(t){$("#p_reset").on("click",function(){t.txt.clear()})}};$(function(){$("#p_sci").length>0&&s.init(),e(5)()}),t.exports={Data:r,Dom:s,Listener:c,editor:a}},function(t,n,e){"use strict";var a={ajax:function(){return new Promise(function(t,n){return $.ajax({url:"/admin/production/image",type:"put",data:a.getForm(),dataType:"json",processData:!1,contentType:!1,success:function(e){e&&"status"in e&&e.status>0?t(e.data):n("message"in e?e.message:"上传图片出错")},error:function(t){console.error(t),n("上传图片超时")}})})},getForm:function(){var t=new FormData;return t.append("img",$("#p_icon").get(0).files[0]),t},init:function(){$("#p_icon").on("change",function(){a.ajax().then(function(){$("#p_icon_val").val(1)}).catch(function(t){return alert(t)})})}};t.exports=a.init},,,,,,,,,,,,,,,function(t,n,e){"use strict";e(3);var a=e(4),i=void 0,o=void 0,r={init:function(){return i=$("#production_list").DataTable({language:e(1),paginType:"full_numbers",lengthMenu:[[10,25,50],[10,25,50]],searching:!1,ordering:!1,processing:!0,serverSide:!0,autoWidth:!0,stateSave:!0,ajax:{url:"/admin/production/list",method:"post",data:function(t){t.state=$("#p_list_state").val(),t.sci=$("#p_sci").val()}},columns:[{title:"编号",width:"26px",data:"id"},{title:"产品名称",data:"name"},{title:"产品标题",data:"title"},{title:"产品二级分类",data:"sci",render:function(t){return o[t]}},{title:"产品状态",data:"state",render:function(t){return'<label class="label label-'+(1===t?"primary":"danger")+'">'+(1===t?"正常":"下架")+"</label>"}},{title:"浏览次数",data:"views"},{title:"是否置顶",data:"sequence",render:function(t){return 0===t?"是":"否"}},{title:"创建时间",data:"created_at",render:function(t){return new Date(t).format("yyyy-MM-dd hh:mm:ss")}},{title:"修改时间",data:"updated_at",render:function(t){return new Date(t).format("yyyy-MM-dd hh:mm:ss")}},{title:"操作",width:"136px",data:null,render:function(t){return'<a class="btn btn-info btn-xs ml-1e" href="/admin/production/update/'+t.id+'">修改信息</a><button class="btn btn-'+(1===t.state?"danger":"primary")+' btn-xs ml-1e production-state" data-pid="'+t.id+'" data-state="'+t.state+'">产品'+(1===t.state?"下架":"上架")+"</button>"}}]})}},s={state:function(t,n){return e(0)({url:"/admin/production/state/"+t+"/"+n,type:"post",text:"产品上下架"})}},c={catalogs:function(){return new Promise(function(t,n){a.Data.catalogs().then(function(n){o=a.Dom.setCatalogsKv(n),$("#p_catalog").html('<option value="-1">--- 全部 ---</option>'+a.Dom.setCatalogs(n)),t()}).catch(function(t){return n(t)})})},init:function(){this.catalogs().then(function(){return r.init()}).catch(function(t){return alert(t)})}},u={searchSubmit:function(){$("#search_submit").one("click",function(){i.ajax.reload(),u.searchSubmit()})},state:function(){$("#production_list").on("click",".production-state",function(){var t=parseInt($(this).data("pid")),n=parseInt($(this).data("state"));s.state(t,1-n).then(function(){return i.ajax.reload()}).catch(function(t){return alert(t)})})},init:function(){this.searchSubmit(),this.state()}};$(function(){c.init(),u.init()})}]);