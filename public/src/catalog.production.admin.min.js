!function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=4)}({4:function(e,n,t){"use strict";function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function e(n){o(this,e),this.id=n.id,this.name=n.name,this.father_id=n.father_id,this.grade=n.grade,this.sequence=n.sequence},a=void 0,i={catalogs:t(7).catalogs,rename:function(e){return new Promise(function(n,t){return $.ajax({url:"/admin/production/catalog",type:"post",data:e,dataType:"json",success:function(e){e&&"status"in e&&e.status>0?n():t("message"in e?e.message:"修改分类名称出错")},error:function(e){console.error(e),t("修改分类名称超时")}})})},add:function(e){return new Promise(function(n,t){$.ajax({url:"/admin/production/catalog",type:"put",data:e,dataType:"json",success:function(e){e&&"status"in e&&e.status>0?n():t("message"in e?e.message:"新增分类出错")},error:function(e){console.error(e),t("新增分类名称超时")}})})},remove:function(e){return new Promise(function(n,t){$.ajax({url:"/admin/production/catalog",type:"delete",data:{cid:e},dataType:"json",success:function(e){e&&"status"in e&&e.status>0?n():t("message"in e?e.message:"新增分类出错")},error:function(e){console.error(e),t("新增分类名称超时")}})})}},s={addHoverDom:function(e,n){var t=$("#"+n.tId+"_span"),o="#addBtn_"+n.tId,r=$(o);if(n.editNameFlag||r.length>0||2===n.grade)return!1;var i='<span class="button add" id="addBtn_'+n.tId+'" title="增加" onfocus="this.blur();"></span>';t.after(i);var s=$(o);s&&s.bind("click",function(){var e=n.getParentNode(),t=n.children,o=100*((e?e.getIndex():1)+1)+(t?t.length+1:0);return a.addNodes(n,{id:o,pId:n.id,name:"新的分类"+o}),!1})},removeHoverDom:function(e,n){return $("#addBtn_"+n.tId).unbind().remove()},catalogs:function(){i.catalogs().then(function(e){return a=$.fn.zTree.init($("#production_catalog"),{view:{addHoverDom:s.addHoverDom,removeHoverDom:s.removeHoverDom,selectedMulti:!1},edit:{enable:!0,removeTitle:"删除",renameTitle:"重命名",showRenameBtn:function(e,n){return!n.noEditBtn},showRemoveBtn:function(e,n){return!n.noEditBtn}},callback:{onNodeCreated:function(e,n,t){if(!("sequence"in t)&&0!==t.level){var o=t.getParentNode(),r={name:t.name,grade:t.level,father_id:o?o.id:0,sequence:t.getIndex()||0,icon:""};i.add(r)}},beforeRemove:function(e,n){if(2===n.level)i.remove(n.id);else{if(n.children&&n.children.length>0)return alert("该分类下有子分类"),!1;i.remove(n.id)}},onRename:function(e,n,t,o){if(!t.name)return alert("请填写分类名称"),!1;i.rename(new r(t))}}},[{name:"产品分类",open:!0,children:e,noEditBtn:!0}])}).catch(function(e){return alert(e)})},init:function(){this.catalogs()}},c={init:function(){}};$(function(){s.init(),c.init()})},7:function(e,n,t){"use strict";e.exports={catalogs:function(){return new Promise(function(e,n){return $.ajax({url:"/admin/production/catalog/list",type:"get",dataType:"json",success:function(t){t&&"status"in t&&t.status>0?e(t.data):n("message"in t?t.message:"获取分类列表出错")},error:function(e){console.error(e),n("获取分类列表超时")}})})}}}});