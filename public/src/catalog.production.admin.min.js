!function(n){function e(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return n[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var t={};e.m=n,e.c=t,e.d=function(n,t,o){e.o(n,t)||Object.defineProperty(n,t,{configurable:!1,enumerable:!0,get:o})},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},e.p="",e(e.s=4)}({4:function(n,e,t){"use strict";function o(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function n(e){o(this,n),this.id=e.id,this.name=e.name,this.father_id=e.father_id,this.grade=e.grade,this.sequence=e.sequence},a=void 0,i={catalogs:function(){return new Promise(function(n,e){return $.ajax({url:"/admin/production/catalog/list",type:"get",dataType:"json",success:function(t){t&&"status"in t&&t.status>0?n(t.data):e("message"in t?t.message:"获取分类列表出错")},error:function(n){console.error(n),e("获取分类列表超时")}})})},rename:function(n){return new Promise(function(e,t){return $.ajax({url:"/admin/production/catalog",type:"post",data:n,dataType:"json",success:function(n){n&&"status"in n&&n.status>0?e():t("message"in n?n.message:"修改分类名称出错")},error:function(n){console.error(n),t("修改分类名称超时")}})})},add:function(n){return new Promise(function(e,t){$.ajax({url:"/admin/production/catalog",type:"put",data:n,dataType:"json",success:function(n){n&&"status"in n&&n.status>0?e():t("message"in n?n.message:"新增分类出错")},error:function(n){console.error(n),t("新增分类名称超时")}})})},remove:function(n){return new Promise(function(n,e){})}},u={addHoverDom:function(n,e){var t=$("#"+e.tId+"_span"),o="#addBtn_"+e.tId,r=$(o);if(e.editNameFlag||r.length>0||2===e.grade)return!1;var i='<span class="button add" id="addBtn_'+e.tId+'" title="增加" onfocus="this.blur();"></span>';t.after(i);var u=$(o);u&&u.bind("click",function(){var n=e.getParentNode(),t=e.children,o=100*((n?n.getIndex():1)+1)+(t?t.length+1:0);return a.addNodes(e,{id:o,pId:e.id,name:"新的分类"+o}),!1})},removeHoverDom:function(n,e){return $("#addBtn_"+e.tId).unbind().remove()},catalogs:function(){i.catalogs().then(function(n){return a=$.fn.zTree.init($("#production_catalog"),{view:{addHoverDom:u.addHoverDom,removeHoverDom:u.removeHoverDom,selectedMulti:!1},edit:{enable:!0,removeTitle:"删除",renameTitle:"重命名",showRenameBtn:function(n,e){return!e.noEditBtn},showRemoveBtn:function(n,e){return!e.noEditBtn}},callback:{onNodeCreated:function(n,e,t){if(!("sequence"in t)&&0!==t.level){var o=t.getParentNode(),r={name:t.name,grade:t.level,father_id:o?o.id:0,sequence:t.getIndex()||0,icon:""};i.add(r)}},onRemove:function(n,e,t){console.info(n,e,t)},onRename:function(n,e,t,o){t.name?i.rename(new r(t)):alert("请填写分类名称")}}},[{name:"产品分类",open:!0,children:n,noEditBtn:!0}])}).catch(function(n){return alert(n)})},init:function(){this.catalogs()}},c={init:function(){}};$(function(){u.init(),c.init()})}});